(self["webpackChunkapp"]=self["webpackChunkapp"]||[]).push([[681],{6681:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return y}});var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"main"}},[s("div",{staticClass:"title"},[e._v("X 云盘")]),s("div",{directives:[{name:"show",rawName:"v-show",value:!e.captchaShow,expression:"!captchaShow"}],staticClass:"container"},[s("div",{staticClass:"opt"},[s("div",{class:1==e.unchoosed?"unchoosed":"",on:{click:function(t){e.unchoosed=2}}},[e._v(" 登录 ")]),s("div",{class:2==e.unchoosed?"unchoosed":"",on:{click:function(t){e.unchoosed=1}}},[e._v(" 注册 ")])]),2==e.unchoosed?s("div",{staticClass:"form"},[s("form",[s("div",{staticClass:"input-box"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.username,expression:"username"}],staticClass:"fm-text",attrs:{type:"text",placeholder:"请输入用户名"},domProps:{value:e.username},on:{input:function(t){t.target.composing||(e.username=t.target.value)}}})]),s("div",{staticClass:"input-box"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.pw,expression:"pw"}],staticClass:"fm-text",attrs:{type:"password",placeholder:"请输入密码"},domProps:{value:e.pw},on:{input:function(t){t.target.composing||(e.pw=t.target.value)}}})]),s("div",{staticClass:"input-box"},[s("button",{on:{click:function(t){return t.preventDefault(),e.changeCaptchaShow.apply(null,arguments)}}},[e._v("登录")])]),s("div",{staticClass:"check"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.autoLogin,expression:"autoLogin"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.autoLogin)?e._i(e.autoLogin,null)>-1:e.autoLogin},on:{change:function(t){var s=e.autoLogin,n=t.target,r=!!n.checked;if(Array.isArray(s)){var a=null,o=e._i(s,a);n.checked?o<0&&(e.autoLogin=s.concat([a])):o>-1&&(e.autoLogin=s.slice(0,o).concat(s.slice(o+1)))}else e.autoLogin=r}}}),e._v("下次自动登录 ")])])]):e._e(),1==e.unchoosed?s("div",{staticClass:"form"},[s("form",[s("div",{staticClass:"input-box"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.username,expression:"username"}],staticClass:"fm-text",attrs:{type:"text",placeholder:"请输入用户名"},domProps:{value:e.username},on:{input:function(t){t.target.composing||(e.username=t.target.value)}}})]),s("div",{staticClass:"input-box"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.pw,expression:"pw"}],staticClass:"fm-text",attrs:{type:"password",placeholder:"请输入密码"},domProps:{value:e.pw},on:{input:function(t){t.target.composing||(e.pw=t.target.value)}}})]),s("div",{staticClass:"input-box"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.rpw,expression:"rpw"}],staticClass:"fm-text",attrs:{type:"password",placeholder:"请再次输入密码"},domProps:{value:e.rpw},on:{input:function(t){t.target.composing||(e.rpw=t.target.value)}}})]),s("div",{staticClass:"input-box"},[s("button",{on:{click:function(t){return t.preventDefault(),e.changeCaptchaShow.apply(null,arguments)}}},[e._v("注册")])])])]):e._e()]),s("captcha",{directives:[{name:"show",rawName:"v-show",value:e.captchaShow,expression:"captchaShow"}],staticClass:"captcha",attrs:{username:e.username,autoLogin:e.autoLogin,pw:e.pw,changeCaptchaShow:e.changeCaptchaShow,captchaShow:e.captchaShow,unchoosed:e.unchoosed}})],1)},r=[],a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"CaptchaContainer"},[s("div",{staticClass:"refresh",on:{click:e.getCapthcaPic}},[e._v("刷新")]),s("div",{staticClass:"close",on:{click:e.close}},[e._v("X")]),s("img",{ref:"captchaPic",attrs:{src:"",alt:""}}),s("img",{ref:"slidePic",staticClass:"slidePic",attrs:{src:"",alt:""}}),s("div",{staticClass:"bn-container"}),s("div",{ref:"coverBG",staticClass:"coverBG"}),s("div",{staticClass:"tip"},[e._v("向右滑动完成拼图")]),s("div",{ref:"slider",staticClass:"slider",on:{mousedown:function(t){return e.sliderMoveStart(t)}}},[e._v(">>>")])])},o=[],i=s(9726),c=s(7906),u=s(6198),l=(s(1539),s(8783),s(3948),s(1637),s(9714),s(2472),s(8675),s(2990),s(8927),s(3105),s(5035),s(4345),s(7174),s(2846),s(4731),s(7209),s(6319),s(8867),s(7789),s(3739),s(9368),s(4483),s(2056),s(3462),s(678),s(7462),s(3824),s(5021),s(2974),s(5016),s(7479),s(7714),s(2801),s(1174),s(3228)),h={name:"captcha",props:["username","pw","autoLogin","changeCaptchaShow","captchaShow","unchoosed"],data:function(){return{MouseStartPos:0,MoveFlag:!1,MouseRoute:[]}},beforeDestroy:function(){console.log("cap destroy"),document.onmousemove=null,document.onmouseup=null},methods:{close:function(){this.$bus.$emit("closeCaptcha")},sliderMoveStart:function(e){this.MouseStartPos=e.clientX,this.MoveFlag=!0},sliderMove:function(e){this.MoveFlag&&(this.MouseRoute.push([e.clientX,e.clientY]),e.clientX-this.MouseStartPos>=0&&e.clientX-this.MouseStartPos<=250?(this.$refs.slidePic.style.left="".concat(e.clientX-this.MouseStartPos,"px"),this.$refs.slider.style.left="".concat(e.clientX-this.MouseStartPos,"px"),this.$refs.coverBG.style.width="".concat(e.clientX-this.MouseStartPos,"px")):e.clientX-this.MouseStartPos<0?(this.$refs.slidePic.style.left=0,this.$refs.slider.style.left=0,this.$refs.coverBG.style.width=0):(this.$refs.slidePic.style.left="250px",this.$refs.slider.style.left="250px",this.$refs.coverBG.style.width="250px"))},sliderMoveEnd:function(e){var t=this;return(0,u.Z)((0,c.Z)().mark((function e(){return(0,c.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:console.log(t.unchoosed),t.MoveFlag&&(t.MoveFlag=!1,2==t.unchoosed?t.login():t.register());case 2:case"end":return e.stop()}}),e)})))()},login:function(){var e=this;return(0,u.Z)((0,c.Z)().mark((function t(){var s;return(0,c.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.log("logining.."),s=new URLSearchParams,s.append("username",e.username),s.append("password",e.pw),s.append("mouseroute",e.MouseRoute.toString()),s.append("sliderPos",e.$refs.slider.style.left),t.prev=6,t.next=9,e.$store.dispatch("login",{params:s,autoLogin:e.autoLogin});case 9:e.$refs.coverBG.style.backgroundColor="green",setTimeout((function(){alert("登录成功"),e.$router.push("/home/folder")}),100),t.next=17;break;case 13:t.prev=13,t.t0=t["catch"](6),e.$refs.coverBG.style.backgroundColor="red","CaptchaError"==t.t0.message?setTimeout((function(){e.$refs.slidePic.style.left=0,e.$refs.slider.style.left=0,e.$refs.coverBG.style.width=0,e.$refs.coverBG.style.backgroundColor="rgba(99, 125, 255, 1)",e.getCapthcaPic()}),200):setTimeout((function(){alert(t.t0.message),e.close()}),100);case 17:case"end":return t.stop()}}),t,null,[[6,13]])})))()},register:function(){var e=this;return(0,u.Z)((0,c.Z)().mark((function t(){var s;return(0,c.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return s=new URLSearchParams,s.append("username",e.username),s.append("password",e.pw),s.append("mouseroute",e.MouseRoute),s.append("sliderPos",e.$refs.slider.style.left),t.prev=5,t.next=8,e.$store.dispatch("register",s);case 8:t.sent,e.$refs.coverBG.style.backgroundColor="green",setTimeout((function(){alert("注册成功"),e.$bus.$emit("resetunchoosed"),e.close()}),200),t.next=17;break;case 13:t.prev=13,t.t0=t["catch"](5),e.$refs.coverBG.style.backgroundColor="red","CaptchaError"==t.t0.message?setTimeout((function(){e.$refs.slidePic.style.left=0,e.$refs.slider.style.left=0,e.$refs.coverBG.style.width=0,e.$refs.coverBG.style.backgroundColor="rgba(99, 125, 255, 1)",e.getCapthcaPic()}),200):setTimeout((function(){alert(t.t0.message),e.close()}),100);case 17:case"end":return t.stop()}}),t,null,[[5,13]])})))()},getCapthcaPic:function(){var e=this;return(0,u.Z)((0,c.Z)().mark((function t(){var s,n,r,a,o,u;return(0,c.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,(0,l.cC)();case 2:for(s=t.sent,console.log(s),console.log(s.captchaPic),console.log((0,i.Z)(s.captchaPic)),n=new Uint8Array(s.captchaPic.data),r="",a=n.byteLength,o=0;o<a;o++)r+=String.fromCharCode(n[o]);for(e.$refs.captchaPic.src="data:image/png;base64,"+window.btoa(r),n=new Uint8Array(s.sliderPic.data),r="",a=n.byteLength,u=0;u<a;u++)r+=String.fromCharCode(n[u]);e.$refs.slidePic.src="data:image/png;base64,"+window.btoa(r),e.$refs.slidePic.style.top=s.posY+"px";case 17:case"end":return t.stop()}}),t)})))()}},watch:{captchaShow:function(e){e&&(this.$refs.slidePic.style.left=0,this.$refs.slider.style.left=0,this.$refs.coverBG.style.width=0,this.$refs.coverBG.style.backgroundColor="rgba(99, 125, 255, 1)",document.onmousemove=this.sliderMove,document.onmouseup=this.sliderMoveEnd,this.getCapthcaPic()),e||(document.onmousemove=null,document.onmouseup=null)}}},p=h,d=s(1001),f=(0,d.Z)(p,a,o,!1,null,"6d6a7707",null),v=f.exports,m={name:"login",components:{captcha:v},mounted:function(){var e=this;this.$bus.$on("closeCaptcha",(function(){e.captchaShow=!e.captchaShow})),this.$bus.$on("resetunchoosed",(function(){e.unchoosed=2}))},data:function(){return{unchoosed:2,autoLogin:!0,username:"",pw:"",rpw:"",captchaShow:!1}},watch:{unchoosed:{handler:function(){this.username="",this.pw="",this.rpw=""}}},methods:{changeCaptchaShow:function(){if(2==this.unchoosed){if(""==this.username||""==this.pw)return void alert("用户名或密码不能为空")}else{if(""==this.username||""==this.pw||""==this.rpw)return void alert("用户名或密码不能为空");if(this.pw!=this.rpw)return alert("两次密码输入不同"),this.pw="",void(this.rpw="")}this.captchaShow=!this.captchaShow}}},g=m,w=(0,d.Z)(g,n,r,!1,null,null,null),y=w.exports},590:function(e,t,s){var n=s(7293),r=s(5112),a=s(1913),o=r("iterator");e.exports=!n((function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,s="";return e.pathname="c%20d",t.forEach((function(e,n){t["delete"]("b"),s+=n+e})),a&&!e.toJSON||!t.sort||"http://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[o]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://тест").host||"#%D0%B1"!==new URL("http://a#б").hash||"a1c3"!==s||"x"!==new URL("http://x",void 0).host}))},5556:function(e,t,s){"use strict";s(6992);var n=s(2109),r=s(7854),a=s(6916),o=s(1702),i=s(9781),c=s(590),u=s(8052),l=s(9190),h=s(8003),p=s(4994),d=s(9909),f=s(5787),v=s(614),m=s(2597),g=s(9974),w=s(648),y=s(9670),C=s(111),b=s(1340),x=s(30),k=s(9114),P=s(8554),S=s(1246),$=s(8053),L=s(5112),R=s(4362),U=L("iterator"),M="URLSearchParams",_=M+"Iterator",G=d.set,B=d.getterFor(M),Z=d.getterFor(_),E=Object.getOwnPropertyDescriptor,X=function(e){if(!i)return r[e];var t=E(r,e);return t&&t.value},A=X("fetch"),N=X("Request"),F=X("Headers"),T=N&&N.prototype,D=F&&F.prototype,O=r.RegExp,j=r.TypeError,q=r.decodeURIComponent,I=r.encodeURIComponent,Q=o("".charAt),z=o([].join),Y=o([].push),H=o("".replace),J=o([].shift),K=o([].splice),V=o("".split),W=o("".slice),ee=/\+/g,te=Array(4),se=function(e){return te[e-1]||(te[e-1]=O("((?:%[\\da-f]{2}){"+e+"})","gi"))},ne=function(e){try{return q(e)}catch(t){return e}},re=function(e){var t=H(e,ee," "),s=4;try{return q(t)}catch(n){while(s)t=H(t,se(s--),ne);return t}},ae=/[!'()~]|%20/g,oe={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},ie=function(e){return oe[e]},ce=function(e){return H(I(e),ae,ie)},ue=p((function(e,t){G(this,{type:_,iterator:P(B(e).entries),kind:t})}),"Iterator",(function(){var e=Z(this),t=e.kind,s=e.iterator.next(),n=s.value;return s.done||(s.value="keys"===t?n.key:"values"===t?n.value:[n.key,n.value]),s}),!0),le=function(e){this.entries=[],this.url=null,void 0!==e&&(C(e)?this.parseObject(e):this.parseQuery("string"==typeof e?"?"===Q(e,0)?W(e,1):e:b(e)))};le.prototype={type:M,bindURL:function(e){this.url=e,this.update()},parseObject:function(e){var t,s,n,r,o,i,c,u=S(e);if(u){t=P(e,u),s=t.next;while(!(n=a(s,t)).done){if(r=P(y(n.value)),o=r.next,(i=a(o,r)).done||(c=a(o,r)).done||!a(o,r).done)throw j("Expected sequence with length 2");Y(this.entries,{key:b(i.value),value:b(c.value)})}}else for(var l in e)m(e,l)&&Y(this.entries,{key:l,value:b(e[l])})},parseQuery:function(e){if(e){var t,s,n=V(e,"&"),r=0;while(r<n.length)t=n[r++],t.length&&(s=V(t,"="),Y(this.entries,{key:re(J(s)),value:re(z(s,"="))}))}},serialize:function(){var e,t=this.entries,s=[],n=0;while(n<t.length)e=t[n++],Y(s,ce(e.key)+"="+ce(e.value));return z(s,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var he=function(){f(this,pe);var e=arguments.length>0?arguments[0]:void 0;G(this,new le(e))},pe=he.prototype;if(l(pe,{append:function(e,t){$(arguments.length,2);var s=B(this);Y(s.entries,{key:b(e),value:b(t)}),s.updateURL()},delete:function(e){$(arguments.length,1);var t=B(this),s=t.entries,n=b(e),r=0;while(r<s.length)s[r].key===n?K(s,r,1):r++;t.updateURL()},get:function(e){$(arguments.length,1);for(var t=B(this).entries,s=b(e),n=0;n<t.length;n++)if(t[n].key===s)return t[n].value;return null},getAll:function(e){$(arguments.length,1);for(var t=B(this).entries,s=b(e),n=[],r=0;r<t.length;r++)t[r].key===s&&Y(n,t[r].value);return n},has:function(e){$(arguments.length,1);var t=B(this).entries,s=b(e),n=0;while(n<t.length)if(t[n++].key===s)return!0;return!1},set:function(e,t){$(arguments.length,1);for(var s,n=B(this),r=n.entries,a=!1,o=b(e),i=b(t),c=0;c<r.length;c++)s=r[c],s.key===o&&(a?K(r,c--,1):(a=!0,s.value=i));a||Y(r,{key:o,value:i}),n.updateURL()},sort:function(){var e=B(this);R(e.entries,(function(e,t){return e.key>t.key?1:-1})),e.updateURL()},forEach:function(e){var t,s=B(this).entries,n=g(e,arguments.length>1?arguments[1]:void 0),r=0;while(r<s.length)t=s[r++],n(t.value,t.key,this)},keys:function(){return new ue(this,"keys")},values:function(){return new ue(this,"values")},entries:function(){return new ue(this,"entries")}},{enumerable:!0}),u(pe,U,pe.entries,{name:"entries"}),u(pe,"toString",(function(){return B(this).serialize()}),{enumerable:!0}),h(he,M),n({global:!0,constructor:!0,forced:!c},{URLSearchParams:he}),!c&&v(F)){var de=o(D.has),fe=o(D.set),ve=function(e){if(C(e)){var t,s=e.body;if(w(s)===M)return t=e.headers?new F(e.headers):new F,de(t,"content-type")||fe(t,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),x(e,{body:k(0,b(s)),headers:k(0,t)})}return e};if(v(A)&&n({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function(e){return A(e,arguments.length>1?ve(arguments[1]):{})}}),v(N)){var me=function(e){return f(this,T),new N(e,arguments.length>1?ve(arguments[1]):{})};T.constructor=me,me.prototype=T,n({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:me})}}e.exports={URLSearchParams:he,getState:B}},1637:function(e,t,s){s(5556)}}]);